<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GTUverse - Real-Time GTU Announcements</title>
    <meta name="description" content="Get instant GTU exam alerts, result updates, syllabus changes, and college notifications. Join 2500+ students staying ahead.">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'><stop offset='0%25' style='stop-color:%236366f1;stop-opacity:1'/><stop offset='100%25' style='stop-color:%23a855f7;stop-opacity:1'/></linearGradient></defs><circle cx='50' cy='50' r='45' fill='url(%23grad)'/><path d='M30 45 L45 30 L70 55 L45 80 Z' fill='white' opacity='0.9'/><circle cx='45' cy='55' r='8' fill='white'/></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@400;500;600;700;800;900&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --accent: #f59e0b;
            --purple: #a855f7;
            --pink: #ec4899;
            --cyan: #06b6d4;
            --dark: #0f172a;
            --dark-light: #1e293b;
            --medium: #475569;
            --light: #f8fafc;
            --white: #ffffff;
            --border: #e2e8f0;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #0a0a0f;
            color: #e2e8f0;
            line-height: 1.7;
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
            transition: background 0.3s ease, color 0.3s ease;
        }
        body.light-mode {
            background: #f8fafc;
            color: #0f172a;
        }
        body.light-mode .gradient-bg { background: linear-gradient(135deg, #f8fafc 0%, #e0e7ff 50%, #f8fafc 100%); }
        body.light-mode .gradient-bg::before,
        body.light-mode .gradient-bg::after { opacity: 0.08; }
        body.light-mode header { background: rgba(248,250,252,.8); border-bottom-color: rgba(99,102,241,.2); }
        body.light-mode header.scrolled { background: rgba(248,250,252,.95); }
        body.light-mode .nav-links a { color: #475569; }
        body.light-mode .nav-links a:hover { color: #6366f1; }
        body.light-mode .announcement-item { background: rgba(255,255,255,.8); border-color: rgba(99,102,241,.15); }
        body.light-mode .announcement-desc,
        body.light-mode .announcement-date,
        body.light-mode .section-subtitle { color: #64748b; }
        body.light-mode .announcement-title { color: #0f172a; }
        body.light-mode .priority-badge { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); }

        .gradient-bg { position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;
            background:linear-gradient(135deg,#0a0a0f 0%,#1a1a2e 50%,#0a0a0f 100%); }
        .gradient-bg::before,.gradient-bg::after{
            content:'';position:absolute;width:800px;height:800px;border-radius:50%;
            filter:blur(120px);opacity:.15;animation:float 20s ease-in-out infinite;
        }
        .gradient-bg::before{background:linear-gradient(135deg,#6366f1 0%,#a855f7 100%);top:-400px;left:-400px;}
        .gradient-bg::after{background:linear-gradient(135deg,#ec4899 0%,#f59e0b 100%);bottom:-400px;right:-400px;animation-delay:-10s;}
        @keyframes float{
            0%,100%{transform:translate(0,0) scale(1);}
            33%{transform:translate(100px,-100px) scale(1.2);}
            66%{transform:translate(-80px,80px) scale(.9);}
        }

        .particles{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;overflow:hidden;}
        .particle{position:absolute;width:3px;height:3px;background:rgba(99,102,241,.5);border-radius:50%;
            animation:particle-float 15s linear infinite;}
        @keyframes particle-float{
            0%{transform:translateY(100vh) translateX(0);opacity:0;}
            10%{opacity:1;}90%{opacity:1;}
            100%{transform:translateY(-100vh) translateX(100px);opacity:0;}
        }

        header{position:fixed;top:0;width:100%;z-index:1000;
            background:rgba(10,10,15,.8);backdrop-filter:blur(20px) saturate(180%);
            border-bottom:1px solid rgba(99,102,241,.1);transition:all .3s ease;}
        header.scrolled{background:rgba(10,10,15,.95);box-shadow:0 10px 40px rgba(0,0,0,.5);
            border-bottom-color:rgba(99,102,241,.3);}
        nav{display:flex;justify-content:space-between;align-items:center;max-width:1400px;margin:auto;padding:1.2rem 2.5rem;}
        .logo{display:flex;align-items:center;gap:1rem;font-family:'Space Grotesk',sans-serif;
            font-size:2rem;font-weight:800;background:linear-gradient(135deg,#6366f1 0%,#a855f7 100%);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;transition:all .3s ease;
            text-decoration:none;letter-spacing:-.02em;position:relative;}
        .logo::after{content:'';position:absolute;bottom:-5px;left:0;width:0;height:3px;
            background:linear-gradient(90deg,#6366f1,#a855f7);transition:width .3s ease;border-radius:2px;}
        .logo:hover::after{width:100%;}
        .logo-icon{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;justify-content:center;
            font-size:2.2rem;font-weight:900;background:linear-gradient(135deg,#6366f1 0%,#8b5cf6 50%,#a855f7 100%);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;
            box-shadow:0 6px 20px rgba(99,102,241,.5),0 0 0 2px rgba(99,102,241,.3);
            animation:logo-pulse 2s ease-in-out infinite;position:relative;overflow:hidden;}
        .logo-icon::after{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;
            background:linear-gradient(45deg,transparent,rgba(99,102,241,.2),transparent);
            animation:logo-shine 3s ease-in-out infinite;z-index:-1;}
        @keyframes logo-shine{0%{transform:translateX(-100%) translateY(-100%) rotate(45deg);}
            100%{transform:translateX(100%) translateY(100%) rotate(45deg);}}
        @keyframes logo-pulse{0%,100%{transform:scale(1);}50%{transform:scale(1.1);}}
        .logo:hover .logo-icon{transform:rotate(360deg) scale(1.15);box-shadow:0 6px 20px rgba(99,102,241,.6);}
        .nav-links{display:flex;list-style:none;gap:.3rem;align-items:center;}
        .nav-links a{color:#cbd5e1;text-decoration:none;padding:.8rem 1.3rem;border-radius:12px;
            font-weight:500;font-size:.95rem;transition:all .3s ease;position:relative;overflow:hidden;}
        .nav-links a::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;
            background:linear-gradient(135deg,rgba(99,102,241,.1) 0%,rgba(168,85,247,.1) 100%);opacity:0;
            transition:opacity .3s ease;}
        .nav-links a:hover::before{opacity:1;}
        .nav-links a:hover{color:#a855f7;transform:translateY(-2px);}
        .telegram-btn{background:linear-gradient(135deg,#229ED9 0%,#3B82F6 100%);color:#fff!important;
            padding:.85rem 1.8rem!important;font-weight:600;box-shadow:0 4px 20px rgba(34,158,217,.4);
            transition:all .3s ease;border:1px solid rgba(255,255,255,.1);}
        .telegram-btn:hover{transform:translateY(-3px);box-shadow:0 8px 30px rgba(34,158,217,.6);}
        .dark-toggle{background:rgba(99,102,241,.15);border:1px solid rgba(99,102,241,.3);color:#6366f1;
            width:46px;height:46px;border-radius:50%;cursor:pointer;transition:all .3s ease;
            display:flex;align-items:center;justify-content:center;font-size:1.2rem;}
        .dark-toggle:hover{background:rgba(99,102,241,.3);transform:rotate(180deg) scale(1.1);
            box-shadow:0 0 20px rgba(99,102,241,.5);}
        .hamburger{display:none;flex-direction:column;cursor:pointer;gap:6px;}
        .hamburger span{width:28px;height:3px;background:#e2e8f0;border-radius:3px;transition:all .3s ease;}
        .hamburger.active span:nth-child(1){transform:rotate(45deg) translate(9px,9px);}
        .hamburger.active span:nth-child(2){opacity:0;}
        .hamburger.active span:nth-child(3){transform:rotate(-45deg) translate(9px,-9px);}

        .announcements{padding:10rem 2rem 6rem;max-width:1200px;margin:auto;min-height:100vh;}
        .section-header{text-align:center;margin-bottom:5rem;}
        .section-title{font-family:'Space Grotesk',sans-serif;font-size:clamp(3rem,7vw,5rem);
            font-weight:800;margin-bottom:1.5rem;background:linear-gradient(135deg,#6366f1 0%,#a855f7 50%,#ec4899 100%);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;line-height:1.15;letter-spacing:-.03em;}
        .section-subtitle{font-size:1.4rem;color:#94a3b8;max-width:750px;margin:auto;line-height:1.9;}
        .announcements-list{list-style:none;display:flex;flex-direction:column;gap:2rem;}
        .announcement-item{background:rgba(30,41,59,.6);backdrop-filter:blur(20px);padding:3rem;
            border-radius:32px;box-shadow:0 10px 40px rgba(0,0,0,.3);border:2px solid rgba(99,102,241,.2);
            transition:all .5s cubic-bezier(.4,0,.2,1);position:relative;overflow:hidden;}
        .announcement-item::before{content:'';position:absolute;top:0;left:0;width:100%;height:100%;
            background:linear-gradient(135deg,rgba(99,102,241,.05) 0%,rgba(168,85,247,.05) 100%);
            opacity:0;transition:opacity .3s ease;}
        .announcement-item:hover::before{opacity:1;}
        .announcement-item:hover{transform:translateY(-12px);box-shadow:0 25px 60px rgba(99,102,241,.4);
            border-color:#6366f1;}
        .announcement-item.top-ann{border-color:#6366f1;background:rgba(99,102,241,.1);}
        .announcement-header{display:flex;align-items:center;gap:1.5rem;margin-bottom:1.8rem;}
        .announcement-icon{width:80px;height:80px;border-radius:20px;
            background:linear-gradient(135deg,#6366f1 0%,#a855f7 100%);
            display:flex;align-items:center;justify-content:center;color:#fff;font-size:2.2rem;
            flex-shrink:0;transition:all .5s ease;box-shadow:0 10px 30px rgba(99,102,241,.4);}
        .announcement-item.top-ann .announcement-icon{
            background:linear-gradient(135deg,#ec4899 0%,#f59e0b 100%);
            animation:pulse-icon 2s ease-in-out infinite;}
        @keyframes pulse-icon{0%,100%{transform:scale(1);}50%{transform:scale(1.1);}}
        .announcement-item:hover .announcement-icon{transform:rotate(360deg) scale(1.2);}
        .announcement-title-wrapper{flex:1;}
        .announcement-title{font-family:'Space Grotesk',sans-serif;font-weight:700;color:#e2e8f0;
            margin-bottom:.6rem;font-size:1.7rem;line-height:1.4;}
        .announcement-date{display:inline-flex;align-items:center;gap:.5rem;color:#94a3b8;
            font-size:.95rem;font-weight:500;}
        .announcement-date i{font-size:.9rem;}
        .announcement-desc{color:#94a3b8;line-height:1.9;font-size:1.1rem;margin-bottom:2rem;}
        .priority-badge{position:absolute;top:1.5rem;right:1.5rem;padding:.5rem 1.2rem;
            border-radius:20px;font-size:.8rem;font-weight:700;text-transform:uppercase;
            letter-spacing:.5px;background:linear-gradient(135deg,#ec4899 0%,#f59e0b 100%);
            color:#fff;box-shadow:0 4px 12px rgba(220,38,38,.3);animation:badge-pulse 2s ease-in-out infinite;}
        @keyframes badge-pulse{0%,100%{transform:scale(1);}50%{transform:scale(1.1);}}
        .announcement-link{display:inline-flex;align-items:center;gap:.8rem;
            background:linear-gradient(135deg,#229ED9 0%,#3B82F6 100%);color:#fff;
            padding:1rem 2rem;border-radius:16px;text-decoration:none;font-weight:600;
            font-size:1.05rem;transition:all .3s ease;box-shadow:0 8px 25px rgba(34,158,217,.4);}
        .announcement-link:hover{transform:translateY(-3px);box-shadow:0 12px 35px rgba(34,158,217,.6);}
        .show-more{display:inline-flex;align-items:center;gap:.8rem;
            background:linear-gradient(135deg,#6366f1 0%,#a855f7 100%);color:#fff;
            padding:1.3rem 3rem;border-radius:16px;text-decoration:none;font-weight:600;
            font-size:1.15rem;margin:4rem auto 0;transition:all .3s ease;
            box-shadow:0 10px 35px rgba(99,102,241,.4);width:fit-content;justify-content:center;}
        .show-more:hover{transform:translateY(-4px);box-shadow:0 15px 45px rgba(99,102,241,.5);}
        .loading{text-align:center;padding:5rem;color:#94a3b8;font-size:1.3rem;}
        .loading i{font-size:3.5rem;margin-bottom:1.2rem;animation:spin 1s linear infinite;
            background:linear-gradient(135deg,#6366f1 0%,#a855f7 100%);
            -webkit-background-clip:text;-webkit-text-fill-color:transparent;}
        @keyframes spin{to{transform:rotate(360deg);}}
        .empty-state{text-align:center;padding:5rem;}
        .empty-state i{font-size:4.5rem;color:#475569;opacity:.3;margin-bottom:1.5rem;}
        .empty-state p{color:#94a3b8;font-size:1.3rem;}
        .fade-in{opacity:0;transform:translateY(60px);transition:opacity 1s ease-out,transform 1s ease-out;}
        .fade-in.visible{opacity:1;transform:translateY(0);}

        .floating-cta{position:fixed;bottom:2.5rem;right:2.5rem;
            background:linear-gradient(135deg,#229ED9 0%,#3B82F6 100%);color:#fff;
            padding:1.2rem 2rem;border-radius:60px;box-shadow:0 15px 40px rgba(34,158,217,.5);
            display:flex;align-items:center;gap:1rem;font-weight:600;z-index:999;
            animation:float-btn 3s ease-in-out infinite;transition:all .3s ease;
            text-decoration:none;border:2px solid rgba(255,255,255,.2);}
        .floating-cta:hover{transform:translateY(-8px) scale(1.08);box-shadow:0 20px 50px rgba(34,158,217,.7);}
        @keyframes float-btn{0%,100%{transform:translateY(0);}50%{transform:translateY(-12px);}}

        @media (max-width:768px){
            .hamburger{display:flex;}
            .nav-links{position:absolute;top:100%;left:0;width:100%;background:rgba(10,10,15,.98);
                backdrop-filter:blur(30px);flex-direction:column;padding:2.5rem;gap:1.2rem;
                box-shadow:0 20px 60px rgba(0,0,0,.5);transform:translateY(-100%);opacity:0;
                visibility:hidden;transition:all .4s cubic-bezier(.4,0,.2,1);
                border-bottom:1px solid rgba(99,102,241,.2);}
            .nav-links.active{transform:translateY(0);opacity:1;visibility:visible;}
            .announcements{padding:8rem 1.8rem 4rem;}
            .announcement-item{padding:2.5rem;}
            .announcement-header{flex-direction:column;align-items:flex-start;}
            .priority-badge{position:static;margin-top:1rem;display:inline-block;}
            .floating-cta{bottom:2rem;right:2rem;padding:1rem 1.5rem;font-size:.95rem;}
        }
        @media (max-width:480px){
            .announcement-item{padding:2rem;}
            .section-title{font-size:2.8rem;}
        }
    </style>
</head>
<body>
    <div class="gradient-bg"></div>
    <div class="particles" id="particles"></div>

    <a href="https://t.me/gtuverse" target="_blank" class="floating-cta">
        <i class="fab fa-telegram-plane"></i> Join Telegram
    </a>

    <header id="header">
        <nav>
            <a href="index.html" class="logo">
                <div class="logo-icon"><span>G</span></div>
                <span>GTUverse</span>
            </a>
            <ul class="nav-links" id="navLinks">
                <li><a href="papers.html">Papers</a></li>
                <li><a href="announcements.html">Announcements</a></li>
                <li><a href="books.html">Books</a></li>
                <li><a href="100ptsbygtuverse.html">100 Points</a></li>
                <li><a href="mailto:gtu.versebyij@gmail.com">Contact</a></li>
                <li><a href="https://t.me/gtuverse" target="_blank" class="telegram-btn">
                    <i class="fab fa-telegram-plane"></i> Join Telegram
                </a></li>
                <li><button class="dark-toggle" onclick="toggleTheme()" aria-label="Toggle Theme">
                    <i class="fas fa-sun" id="themeIcon"></i>
                </button></li>
            </ul>
            <div class="hamburger" id="hamburger" onclick="toggleMenu()" aria-label="Toggle Menu">
                <span></span><span></span><span></span>
            </div>
        </nav>
    </header>

    <section class="announcements">
        <div class="section-header fade-in">
            <h2 class="section-title">GTU Announcements</h2>
            <p class="section-subtitle">Real-time updates on exam schedules, results, syllabus changes, and important alerts. Never miss a beat.</p>
        </div>
        <ul class="announcements-list" id="announcementsList">
            <li class="loading"><i class="fas fa-spinner"></i><p>Loading announcements...</p></li>
        </ul>
        <a href="#" class="show-more" id="showMoreBtn" style="display:none;">
            Show More Announcements <i class="fas fa-arrow-down"></i>
        </a>
    </section>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getFirestore, collection, getDocs, query, orderBy, limit, startAfter } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyC0QTiJoEIkS7rGDFrd057Kx3nMz7_s2EI",
            authDomain: "gtu-verse.firebaseapp.com",
            projectId: "gtu-verse",
            storageBucket: "gtu-verse.firebasestorage.app",
            messagingSenderId: "99377635087",
            appId: "1:99377635087:web:05ba93798e36040cfe287a",
            measurementId: "G-YV4W2LT96S"
        };

        try {
            const app = initializeApp(firebaseConfig);
            const db = getFirestore(app);
            let lastDoc = null;
            const pageSize = 10;

            /* ---------- UI Helpers ---------- */
            function toggleTheme() {
                const body = document.body;
                const icon = document.getElementById('themeIcon');
                body.classList.toggle('light-mode');
                const isLight = body.classList.contains('light-mode');
                icon.classList.toggle('fa-sun', !isLight);
                icon.classList.toggle('fa-moon', isLight);
                localStorage.setItem('theme', isLight ? 'light' : 'dark');
            }
            function loadTheme() {
                const saved = localStorage.getItem('theme');
                if (saved === 'light') {
                    document.body.classList.add('light-mode');
                    document.getElementById('themeIcon').classList.replace('fa-sun', 'fa-moon');
                }
            }
            function toggleMenu() {
                document.getElementById('navLinks').classList.toggle('active');
                document.getElementById('hamburger').classList.toggle('active');
            }
            window.addEventListener('scroll', () => {
                document.getElementById('header').classList.toggle('scrolled', window.scrollY > 50);
            });

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('visible'); });
            }, { threshold: 0.1, rootMargin: '0px 0px -100px 0px' });
            document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));

            /* ---------- Firestore ---------- */
            async function loadAnnouncements(reset = true) {
                const list = document.getElementById('announcementsList');
                try {
                    let q = query(collection(db, 'announcements'), orderBy('createdAt', 'desc'), limit(pageSize));
                    if (!reset && lastDoc) q = query(q, startAfter(lastDoc));
                    const snapshot = await getDocs(q);
                    const anns = snapshot.docs.map(d => ({ id: d.id, ...d.data() }));
                    lastDoc = snapshot.docs[snapshot.docs.length - 1] || null;
                    document.getElementById('showMoreBtn').style.display = snapshot.docs.length < pageSize ? 'none' : 'flex';

                    if (reset) list.innerHTML = '';
                    if (anns.length) {
                        const items = anns.map((a, i) => {
                            // ---- Fixed link handling ----
                            const linkBtn = a.link ? `
                                <a href="${a.link}" target="_blank" rel="noopener" class="announcement-link">
                                    <i class="fas fa-external-link-alt"></i> Read Full
                                </a>` : '';
                            return `
                                <li class="announcement-item fade-in ${i < 3 && reset ? 'top-ann' : ''}">
                                    ${i < 3 && reset ? '<span class="priority-badge"><i class="fas fa-star"></i> Priority</span>' : ''}
                                    <div class="announcement-header">
                                        <div class="announcement-icon"><i class="fas fa-bullhorn"></i></div>
                                        <div class="announcement-title-wrapper">
                                            <h3 class="announcement-title">${a.title || 'Untitled'}</h3>
                                            <div class="announcement-date"><i class="far fa-calendar-alt"></i> ${a.date || 'No date'}</div>
                                        </div>
                                    </div>
                                    <p class="announcement-desc">${a.desc || 'No description.'}</p>
                                    ${linkBtn}
                                </li>`;
                        }).join('');
                        list.innerHTML += items;
                    } else if (reset) {
                        list.innerHTML = '<li class="empty-state"><i class="fas fa-inbox"></i><p>No announcements yet. Check back soon!</p></li>';
                    }
                    document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
                } catch (err) {
                    console.error(err);
                    list.innerHTML = `<li class="empty-state"><i class="fas fa-exclamation-circle"></i><p>Failed to load. Please try again.</p></li>`;
                }
            }

            document.getElementById('showMoreBtn').addEventListener('click', e => {
                e.preventDefault();
                const btn = e.currentTarget;
                btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Loading...';
                btn.style.pointerEvents = 'none';
                loadAnnouncements(false).then(() => {
                    btn.innerHTML = 'Show More Announcements <i class="fas fa-arrow-down"></i>';
                    btn.style.pointerEvents = 'auto';
                });
            });

            /* ---------- Particles ---------- */
            function createParticles() {
                const container = document.getElementById('particles');
                for (let i = 0; i < 30; i++) {
                    const p = document.createElement('div');
                    p.className = 'particle';
                    p.style.left = Math.random() * 100 + '%';
                    p.style.animationDelay = Math.random() * 15 + 's';
                    p.style.animationDuration = 15 + Math.random() * 10 + 's';
                    container.appendChild(p);
                }
            }

            window.addEventListener('load', () => {
                loadTheme();
                createParticles();
                loadAnnouncements();
            });
        } catch (e) {
            console.error('Firebase init error:', e);
            document.getElementById('announcementsList').innerHTML = '<li class="empty-state"><i class="fas fa-exclamation-circle"></i><p>Service unavailable.</p></li>';
        }
    </script>
</body>
</html>
